#!/bin/bash

# Perform steps to setup docker-engine and docker Compose

. ./setup-vars

# Let's see what distribution we're running (Debian or Ubuntu)
DISTRIBUTION_NAME=$(awk -- 'BEGIN{FS="="}$1~/^ID/{print $2}' /etc/os-release)

case "$DISTRIBUTION_NAME" in
    debian)
        DOCKER_REPO="deb https://apt.dockerproject.org/repo debian-jessie main"
        SOURCES_FILE="/etc/apt/sources.list" ;;
    ubuntu)
        DOCKER_REPO="deb https://apt.dockerproject.org/repo ubuntu-xenial main"
        SOURCES_FILE="/etc/apt/sources.list.d/docker.list" ;;
esac

apt-get update && \
    apt-get install apt-transport-https ca-certificates && \
    apt-key adv --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D && \
    echo "" >> /etc/apt-sources.list && \
    echo "$DOCKER_REPO" >> $SOURCES_FILE && \
    apt-get update && \
    apt-get install docker-engine && \
    service docker start | $DIALOG --backtitle $BTITLE \
        --title "Setting up docker" \
        --infobox 0 0


